# AWS Cost AI Agent - Architecture

## ğŸ—ï¸ System Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                          â”‚
â”‚                              AWS COST AI AGENT v3.0                                      â”‚
â”‚                              â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                      â”‚
â”‚                                                                                          â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚                              PRESENTATION LAYER                                  â”‚  â”‚
â”‚    â”‚                                                                                  â”‚  â”‚
â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚    â”‚   â”‚                         REST API (FastAPI)                               â”‚  â”‚  â”‚
â”‚    â”‚   â”‚                                                                          â”‚  â”‚  â”‚
â”‚    â”‚   â”‚   /api/health          - Health check                                   â”‚  â”‚  â”‚
â”‚    â”‚   â”‚   /api/teams           - Team management                                â”‚  â”‚  â”‚
â”‚    â”‚   â”‚   /api/config          - Configuration                                  â”‚  â”‚  â”‚
â”‚    â”‚   â”‚   /api/trigger/*       - Manual triggers                                â”‚  â”‚  â”‚
â”‚    â”‚   â”‚   /api/preview/*       - Report previews                                â”‚  â”‚  â”‚
â”‚    â”‚   â”‚   /api/ai/*            - AI analysis endpoints                          â”‚  â”‚  â”‚
â”‚    â”‚   â”‚   /api/costs/*         - Cost data queries                              â”‚  â”‚  â”‚
â”‚    â”‚   â”‚   /api/anomalies       - Anomaly queries                                â”‚  â”‚  â”‚
â”‚    â”‚   â”‚                                                                          â”‚  â”‚  â”‚
â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚    â”‚                                        â”‚                                        â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                             â”‚                                            â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚                              BUSINESS LOGIC LAYER                               â”‚  â”‚
â”‚    â”‚                                        â”‚                                        â”‚  â”‚
â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚    â”‚   â”‚                â”‚   â”‚                               â”‚   â”‚                â”‚  â”‚  â”‚
â”‚    â”‚   â”‚   SCHEDULER    â”‚   â”‚        COST ANALYZER          â”‚   â”‚   AI SERVICE   â”‚  â”‚  â”‚
â”‚    â”‚   â”‚   (APScheduler)â”‚   â”‚                               â”‚   â”‚  (Gemini 3)    â”‚  â”‚  â”‚
â”‚    â”‚   â”‚                â”‚   â”‚   â€¢ Compare month-over-month  â”‚   â”‚                â”‚  â”‚  â”‚
â”‚    â”‚   â”‚   â€¢ Weekly     â”‚   â”‚   â€¢ Calculate % change        â”‚   â”‚   â€¢ Analyze    â”‚  â”‚  â”‚
â”‚    â”‚   â”‚     cron job   â”‚â”€â”€â–¶â”‚   â€¢ Detect anomalies          â”‚â”€â”€â–¶â”‚     anomalies  â”‚  â”‚  â”‚
â”‚    â”‚   â”‚   â€¢ Configur-  â”‚   â”‚   â€¢ Service breakdown         â”‚   â”‚   â€¢ Predict    â”‚  â”‚  â”‚
â”‚    â”‚   â”‚     able day/  â”‚   â”‚   â€¢ Flag thresholds           â”‚   â”‚     costs      â”‚  â”‚  â”‚
â”‚    â”‚   â”‚     hour       â”‚   â”‚                               â”‚   â”‚   â€¢ Generate   â”‚  â”‚  â”‚
â”‚    â”‚   â”‚                â”‚   â”‚                               â”‚   â”‚     recommend- â”‚  â”‚  â”‚
â”‚    â”‚   â”‚                â”‚   â”‚                               â”‚   â”‚     ations     â”‚  â”‚  â”‚
â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚    â”‚                                        â”‚                                        â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                             â”‚                                            â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚                              INTEGRATION LAYER                                  â”‚  â”‚
â”‚    â”‚                                        â”‚                                        â”‚  â”‚
â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚    â”‚   â”‚                â”‚   â”‚                               â”‚   â”‚                â”‚  â”‚  â”‚
â”‚    â”‚   â”‚   DATADOG      â”‚   â”‚        EMAIL SERVICE          â”‚   â”‚   S3 STORAGE   â”‚  â”‚  â”‚
â”‚    â”‚   â”‚   SERVICE      â”‚   â”‚          (SMTP)               â”‚   â”‚   SERVICE      â”‚  â”‚  â”‚
â”‚    â”‚   â”‚                â”‚   â”‚                               â”‚   â”‚                â”‚  â”‚  â”‚
â”‚    â”‚   â”‚   â€¢ Fetch      â”‚   â”‚   â€¢ Generate HTML emails      â”‚   â”‚   â€¢ Store      â”‚  â”‚  â”‚
â”‚    â”‚   â”‚     aws.cost.* â”‚   â”‚   â€¢ Team reports              â”‚   â”‚     config     â”‚  â”‚  â”‚
â”‚    â”‚   â”‚   â€¢ 84 AWS     â”‚   â”‚   â€¢ Admin consolidated        â”‚   â”‚   â€¢ Store      â”‚  â”‚  â”‚
â”‚    â”‚   â”‚     accounts   â”‚   â”‚   â€¢ Datadog links             â”‚   â”‚     teams      â”‚  â”‚  â”‚
â”‚    â”‚   â”‚   â€¢ Service    â”‚   â”‚   â€¢ AI insights embedded      â”‚   â”‚   â€¢ Store      â”‚  â”‚  â”‚
â”‚    â”‚   â”‚     breakdown  â”‚   â”‚                               â”‚   â”‚     cost data  â”‚  â”‚  â”‚
â”‚    â”‚   â”‚                â”‚   â”‚                               â”‚   â”‚   â€¢ Store      â”‚  â”‚  â”‚
â”‚    â”‚   â”‚                â”‚   â”‚                               â”‚   â”‚     anomalies  â”‚  â”‚  â”‚
â”‚    â”‚   â”‚                â”‚   â”‚                               â”‚   â”‚   â€¢ Store AI   â”‚  â”‚  â”‚
â”‚    â”‚   â”‚                â”‚   â”‚                               â”‚   â”‚     insights   â”‚  â”‚  â”‚
â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚    â”‚           â”‚                            â”‚                           â”‚            â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                â”‚                            â”‚                           â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                            â”‚                           â”‚
                 â–¼                            â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        â”‚    â”‚                        â”‚    â”‚                        â”‚
â”‚       DATADOG          â”‚    â”‚     OUTLOOK/SMTP       â”‚    â”‚       AWS S3           â”‚
â”‚                        â”‚    â”‚                        â”‚    â”‚                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ AWS Cost       â”‚   â”‚    â”‚   â”‚ Team Emails    â”‚   â”‚    â”‚   â”‚ config/        â”‚   â”‚
â”‚   â”‚ Management     â”‚   â”‚    â”‚   â”‚ (84 reports)   â”‚   â”‚    â”‚   â”‚                â”‚   â”‚
â”‚   â”‚ Integration    â”‚   â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚   â”‚ teams/         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚   â”‚                â”‚   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚   â”‚ Admin Emails   â”‚   â”‚    â”‚   â”‚ costs/         â”‚   â”‚
â”‚   â”‚ 84 AWS         â”‚   â”‚    â”‚   â”‚ (consolidated) â”‚   â”‚    â”‚   â”‚                â”‚   â”‚
â”‚   â”‚ Accounts       â”‚   â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚   â”‚ anomalies/     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚                        â”‚    â”‚   â”‚                â”‚   â”‚
â”‚                        â”‚    â”‚                        â”‚    â”‚   â”‚ ai_insights/   â”‚   â”‚
â”‚                        â”‚    â”‚                        â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                 â”‚                            â”‚                           â”‚
                 â”‚                            â”‚                           â”‚
                 â–¼                            â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                        â”‚
â”‚                                 GOOGLE GEMINI AI                                       â”‚
â”‚                                 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                        â”‚
â”‚                                                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚   â”‚                      â”‚  â”‚                      â”‚  â”‚                      â”‚       â”‚
â”‚   â”‚   ANOMALY            â”‚  â”‚   COST               â”‚  â”‚   OPTIMIZATION       â”‚       â”‚
â”‚   â”‚   EXPLANATION        â”‚  â”‚   PREDICTION         â”‚  â”‚   RECOMMENDATIONS    â”‚       â”‚
â”‚   â”‚                      â”‚  â”‚                      â”‚  â”‚                      â”‚       â”‚
â”‚   â”‚   "Why did costs     â”‚  â”‚   "Based on 6 months â”‚  â”‚   "Top 5 ways to     â”‚       â”‚
â”‚   â”‚   increase 45%?"     â”‚  â”‚   of data, predict   â”‚  â”‚   reduce costs       â”‚       â”‚
â”‚   â”‚                      â”‚  â”‚   next month..."     â”‚  â”‚   across org..."     â”‚       â”‚
â”‚   â”‚   â†’ Root cause       â”‚  â”‚                      â”‚  â”‚                      â”‚       â”‚
â”‚   â”‚   â†’ Service impact   â”‚  â”‚   â†’ Trend analysis   â”‚  â”‚   â†’ RI recommendationsâ”‚      â”‚
â”‚   â”‚   â†’ Action items     â”‚  â”‚   â†’ Confidence level â”‚  â”‚   â†’ Right-sizing     â”‚       â”‚
â”‚   â”‚                      â”‚  â”‚   â†’ Risk factors     â”‚  â”‚   â†’ Cleanup unused   â”‚       â”‚
â”‚   â”‚                      â”‚  â”‚                      â”‚  â”‚                      â”‚       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                  WEEKLY WORKFLOW                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚          â”‚         â”‚          â”‚         â”‚          â”‚         â”‚          â”‚
     â”‚  STEP 1  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  STEP 2  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  STEP 3  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  STEP 4  â”‚
     â”‚  FETCH   â”‚         â”‚  ANALYZE â”‚         â”‚    AI    â”‚         â”‚   SEND   â”‚
     â”‚          â”‚         â”‚          â”‚         â”‚          â”‚         â”‚          â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                    â”‚                    â”‚                    â”‚
          â–¼                    â–¼                    â–¼                    â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚             â”‚      â”‚             â”‚      â”‚             â”‚      â”‚             â”‚
   â”‚  Datadog    â”‚      â”‚  Compare    â”‚      â”‚  Gemini AI  â”‚      â”‚  Email      â”‚
   â”‚  API call   â”‚      â”‚  current vs â”‚      â”‚  analyzes   â”‚      â”‚  HTML       â”‚
   â”‚  for each   â”‚      â”‚  previous   â”‚      â”‚  patterns,  â”‚      â”‚  reports    â”‚
   â”‚  of 84      â”‚      â”‚  month      â”‚      â”‚  explains   â”‚      â”‚  to teams   â”‚
   â”‚  accounts   â”‚      â”‚             â”‚      â”‚  WHY        â”‚      â”‚  & admins   â”‚
   â”‚             â”‚      â”‚  Flag if    â”‚      â”‚             â”‚      â”‚             â”‚
   â”‚  Get cost   â”‚      â”‚  change >   â”‚      â”‚  Predicts   â”‚      â”‚  Include    â”‚
   â”‚  breakdown  â”‚      â”‚  threshold  â”‚      â”‚  next month â”‚      â”‚  Datadog    â”‚
   â”‚  by service â”‚      â”‚  (anomaly)  â”‚      â”‚             â”‚      â”‚  links      â”‚
   â”‚             â”‚      â”‚             â”‚      â”‚  Recommends â”‚      â”‚             â”‚
   â”‚             â”‚      â”‚             â”‚      â”‚  savings    â”‚      â”‚             â”‚
   â”‚             â”‚      â”‚             â”‚      â”‚             â”‚      â”‚             â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                    â”‚                    â”‚                    â”‚
          â–¼                    â–¼                    â–¼                    â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                                                                             â”‚
   â”‚                              AWS S3 STORAGE                                 â”‚
   â”‚                                                                             â”‚
   â”‚    costs/2026/02/        anomalies/2026/02/        ai_insights/2026/02/    â”‚
   â”‚    â””â”€â”€ {account}.json    â””â”€â”€ anomalies.json       â””â”€â”€ insights.json       â”‚
   â”‚                                                                             â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—„ï¸ S3 Storage Structure

```
aws-cost-agent-data/                          â† S3 Bucket
â”‚
â”œâ”€â”€ config/
â”‚   â””â”€â”€ notification_config.json              â† Agent configuration
â”‚       {
â”‚         "anomaly_threshold": 20.0,
â”‚         "schedule_day": "monday",
â”‚         "schedule_hour": 9,
â”‚         "global_admin_emails": ["admin@company.com"],
â”‚         "ai_enabled": true
â”‚       }
â”‚
â”œâ”€â”€ teams/
â”‚   â””â”€â”€ teams.json                            â† All 84 team mappings
â”‚       {
â”‚         "teams": [
â”‚           {
â”‚             "id": "uuid-1",
â”‚             "team_name": "Platform Team",
â”‚             "aws_account_id": "123456789012",
â”‚             "team_email": "platform@company.com"
â”‚           },
â”‚           {
â”‚             "id": "uuid-2",
â”‚             "team_name": "DevOps Team",
â”‚             "aws_account_id": "234567890123",
â”‚             "team_email": "devops@company.com"
â”‚           }
â”‚           ... (84 teams)
â”‚         ]
â”‚       }
â”‚
â”œâ”€â”€ costs/
â”‚   â””â”€â”€ 2026/
â”‚       â””â”€â”€ 02/
â”‚           â”œâ”€â”€ 123456789012.json             â† Cost data per account
â”‚           â”‚   {
â”‚           â”‚     "aws_account_id": "123456789012",
â”‚           â”‚     "month": "2026-02",
â”‚           â”‚     "records": [
â”‚           â”‚       {
â”‚           â”‚         "total_cost": 45230.00,
â”‚           â”‚         "service_breakdown": {
â”‚           â”‚           "EC2": 18500,
â”‚           â”‚           "RDS": 12800,
â”‚           â”‚           "S3": 5200
â”‚           â”‚         },
â”‚           â”‚         "fetched_at": "2026-02-12T09:00:00Z"
â”‚           â”‚       }
â”‚           â”‚     ]
â”‚           â”‚   }
â”‚           â”œâ”€â”€ 234567890123.json
â”‚           â””â”€â”€ ... (84 accounts)
â”‚
â”œâ”€â”€ anomalies/
â”‚   â””â”€â”€ 2026/
â”‚       â””â”€â”€ 02/
â”‚           â””â”€â”€ anomalies.json                â† Detected cost spikes
â”‚               {
â”‚                 "month": "2026-02",
â”‚                 "anomalies": [
â”‚                   {
â”‚                     "team_name": "DevOps Team",
â”‚                     "aws_account_id": "234567890123",
â”‚                     "current_cost": 113400,
â”‚                     "previous_cost": 78000,
â”‚                     "percentage_change": 45.2,
â”‚                     "ai_explanation": "EC2 scaling due to..."
â”‚                   }
â”‚                 ]
â”‚               }
â”‚
â””â”€â”€ ai_insights/
    â””â”€â”€ 2026/
        â””â”€â”€ 02/
            â””â”€â”€ insights.json                 â† AI learning history
                {
                  "month": "2026-02",
                  "insights": [
                    {
                      "type": "weekly_report",
                      "executive_summary": "Total spend...",
                      "recommendations": {...},
                      "generated_at": "2026-02-12T09:00:00Z"
                    }
                  ]
                }
```

---

## ğŸ”Œ Component Details

### 1. REST API (FastAPI)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         REST API                                 â”‚
â”‚                        Port: 8001                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   HEALTH & STATUS                                                â”‚
â”‚   â”œâ”€â”€ GET  /api/health           â†’ System health                â”‚
â”‚   â”œâ”€â”€ GET  /api/                 â†’ Agent info                   â”‚
â”‚   â”œâ”€â”€ GET  /api/scheduler/status â†’ Next run time                â”‚
â”‚   â””â”€â”€ GET  /api/storage/info     â†’ Storage config               â”‚
â”‚                                                                  â”‚
â”‚   TEAM MANAGEMENT                                                â”‚
â”‚   â”œâ”€â”€ GET    /api/teams          â†’ List all teams               â”‚
â”‚   â”œâ”€â”€ POST   /api/teams          â†’ Add single team              â”‚
â”‚   â”œâ”€â”€ POST   /api/teams/bulk     â†’ Add multiple teams           â”‚
â”‚   â”œâ”€â”€ GET    /api/teams/{id}     â†’ Get team details             â”‚
â”‚   â””â”€â”€ DELETE /api/teams/{id}     â†’ Remove team                  â”‚
â”‚                                                                  â”‚
â”‚   CONFIGURATION                                                  â”‚
â”‚   â”œâ”€â”€ GET  /api/config           â†’ Get settings                 â”‚
â”‚   â””â”€â”€ PUT  /api/config           â†’ Update settings              â”‚
â”‚                                                                  â”‚
â”‚   AI ANALYSIS                                                    â”‚
â”‚   â”œâ”€â”€ POST /api/ai/analyze/{id}  â†’ Analyze single team          â”‚
â”‚   â”œâ”€â”€ GET  /api/ai/recommendations â†’ Org-wide tips              â”‚
â”‚   â””â”€â”€ GET  /api/ai/insights      â†’ Historical insights          â”‚
â”‚                                                                  â”‚
â”‚   REPORTS                                                        â”‚
â”‚   â”œâ”€â”€ POST /api/trigger/weekly-report    â†’ Run full report      â”‚
â”‚   â”œâ”€â”€ POST /api/trigger/team-report/{id} â†’ Run team report      â”‚
â”‚   â”œâ”€â”€ GET  /api/preview/team-report/{id} â†’ Preview team         â”‚
â”‚   â””â”€â”€ GET  /api/preview/admin-report     â†’ Preview admin        â”‚
â”‚                                                                  â”‚
â”‚   DATA QUERIES                                                   â”‚
â”‚   â”œâ”€â”€ GET  /api/costs/history    â†’ Historical costs             â”‚
â”‚   â””â”€â”€ GET  /api/anomalies        â†’ Detected anomalies           â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Scheduler (APScheduler)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SCHEDULER                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   TYPE: AsyncIOScheduler with CronTrigger                       â”‚
â”‚                                                                  â”‚
â”‚   CONFIGURATION:                                                 â”‚
â”‚   â”œâ”€â”€ schedule_day: monday (configurable)                       â”‚
â”‚   â”œâ”€â”€ schedule_hour: 9 (UTC, configurable)                      â”‚
â”‚   â””â”€â”€ job_id: weekly_cost_report                                â”‚
â”‚                                                                  â”‚
â”‚   WORKFLOW:                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚   Every {schedule_day} at {schedule_hour}:00 UTC        â”‚   â”‚
â”‚   â”‚                         â”‚                                â”‚   â”‚
â”‚   â”‚                         â–¼                                â”‚   â”‚
â”‚   â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚   â”‚
â”‚   â”‚              â”‚ run_weekly_report() â”‚                    â”‚   â”‚
â”‚   â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚   â”‚
â”‚   â”‚                         â”‚                                â”‚   â”‚
â”‚   â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚   â”‚
â”‚   â”‚         â–¼               â–¼               â–¼               â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚   â”‚
â”‚   â”‚   â”‚ Fetch    â”‚   â”‚ Analyze  â”‚   â”‚ Send     â”‚          â”‚   â”‚
â”‚   â”‚   â”‚ Data     â”‚   â”‚ + AI     â”‚   â”‚ Emails   â”‚          â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. AI Service (Gemini 3 Flash)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      AI SERVICE (GEMINI)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   MODEL: gemini-3-flash-preview                                 â”‚
â”‚   LIBRARY: emergentintegrations.llm.chat                        â”‚
â”‚                                                                  â”‚
â”‚   CAPABILITIES:                                                  â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚   1. ANOMALY EXPLANATION                                 â”‚   â”‚
â”‚   â”‚      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                               â”‚   â”‚
â”‚   â”‚      Input:  Cost data (current vs previous)            â”‚   â”‚
â”‚   â”‚      Output: Root cause analysis                         â”‚   â”‚
â”‚   â”‚              â€¢ Why did costs change?                     â”‚   â”‚
â”‚   â”‚              â€¢ Which services drove the change?          â”‚   â”‚
â”‚   â”‚              â€¢ Specific events that caused spike         â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚   2. COST PREDICTION                                     â”‚   â”‚
â”‚   â”‚      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                â”‚   â”‚
â”‚   â”‚      Input:  Historical cost data (6-12 months)         â”‚   â”‚
â”‚   â”‚      Output: Next month forecast                         â”‚   â”‚
â”‚   â”‚              â€¢ Predicted cost range                      â”‚   â”‚
â”‚   â”‚              â€¢ Confidence level                          â”‚   â”‚
â”‚   â”‚              â€¢ Risk factors                              â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚   3. OPTIMIZATION RECOMMENDATIONS                        â”‚   â”‚
â”‚   â”‚      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚   â”‚
â”‚   â”‚      Input:  All teams cost data                         â”‚   â”‚
â”‚   â”‚      Output: Org-wide savings opportunities              â”‚   â”‚
â”‚   â”‚              â€¢ Reserved Instance suggestions             â”‚   â”‚
â”‚   â”‚              â€¢ Right-sizing recommendations              â”‚   â”‚
â”‚   â”‚              â€¢ Unused resource cleanup                   â”‚   â”‚
â”‚   â”‚              â€¢ Storage optimization                      â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚   4. EXECUTIVE SUMMARY                                   â”‚   â”‚
â”‚   â”‚      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                 â”‚   â”‚
â”‚   â”‚      Input:  All teams data + anomalies                  â”‚   â”‚
â”‚   â”‚      Output: C-level summary                             â”‚   â”‚
â”‚   â”‚              â€¢ Overall trend                             â”‚   â”‚
â”‚   â”‚              â€¢ Key concerns                              â”‚   â”‚
â”‚   â”‚              â€¢ Action items                              â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”— External Integrations

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           EXTERNAL SERVICES                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       DATADOG           â”‚     â”‚      GOOGLE AI          â”‚
â”‚                         â”‚     â”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ API Endpoint      â”‚  â”‚     â”‚  â”‚ API Endpoint      â”‚  â”‚
â”‚  â”‚ api.datadoghq.com â”‚  â”‚     â”‚  â”‚ generativelang-   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚  â”‚ uage.googleapis   â”‚  â”‚
â”‚                         â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚                         â”‚
â”‚  â”‚ Auth              â”‚  â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ DD-API-KEY        â”‚  â”‚     â”‚  â”‚ Auth              â”‚  â”‚
â”‚  â”‚ DD-APPLICATION-KEYâ”‚  â”‚     â”‚  â”‚ GEMINI_API_KEY    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚     â”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Data Retrieved    â”‚  â”‚     â”‚  â”‚ Model             â”‚  â”‚
â”‚  â”‚ aws.cost.*        â”‚  â”‚     â”‚  â”‚ gemini-3-flash    â”‚  â”‚
â”‚  â”‚ metrics           â”‚  â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚                         â”‚
â”‚                         â”‚     â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       AWS S3            â”‚     â”‚      SMTP SERVER        â”‚
â”‚                         â”‚     â”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ API Endpoint      â”‚  â”‚     â”‚  â”‚ Server            â”‚  â”‚
â”‚  â”‚ s3.amazonaws.com  â”‚  â”‚     â”‚  â”‚ smtp.office365.comâ”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚     â”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Auth              â”‚  â”‚     â”‚  â”‚ Auth              â”‚  â”‚
â”‚  â”‚ AWS_ACCESS_KEY_ID â”‚  â”‚     â”‚  â”‚ SMTP_USER         â”‚  â”‚
â”‚  â”‚ AWS_SECRET_ACCESS â”‚  â”‚     â”‚  â”‚ SMTP_PASSWORD     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚     â”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Bucket            â”‚  â”‚     â”‚  â”‚ Port              â”‚  â”‚
â”‚  â”‚ aws-cost-agent-   â”‚  â”‚     â”‚  â”‚ 587 (TLS)         â”‚  â”‚
â”‚  â”‚ data              â”‚  â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚                         â”‚
â”‚                         â”‚     â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ–¥ï¸ Deployment Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              EC2 INSTANCE                                    â”‚
â”‚                          (Ubuntu 22.04 LTS)                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                         SYSTEMD SERVICE                              â”‚   â”‚
â”‚   â”‚                    aws-cost-agent.service                            â”‚   â”‚
â”‚   â”‚                                                                      â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚   â”‚   â”‚                    PYTHON VIRTUAL ENV                        â”‚  â”‚   â”‚
â”‚   â”‚   â”‚                     /opt/aws-cost-agent/venv                 â”‚  â”‚   â”‚
â”‚   â”‚   â”‚                                                              â”‚  â”‚   â”‚
â”‚   â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚   â”‚
â”‚   â”‚   â”‚   â”‚                   UVICORN SERVER                     â”‚  â”‚  â”‚   â”‚
â”‚   â”‚   â”‚   â”‚                    Port: 8001                        â”‚  â”‚  â”‚   â”‚
â”‚   â”‚   â”‚   â”‚                                                      â”‚  â”‚  â”‚   â”‚
â”‚   â”‚   â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”‚   â”‚
â”‚   â”‚   â”‚   â”‚   â”‚              FASTAPI APP                     â”‚  â”‚  â”‚  â”‚   â”‚
â”‚   â”‚   â”‚   â”‚   â”‚             (server.py)                      â”‚  â”‚  â”‚  â”‚   â”‚
â”‚   â”‚   â”‚   â”‚   â”‚                                              â”‚  â”‚  â”‚  â”‚   â”‚
â”‚   â”‚   â”‚   â”‚   â”‚  â€¢ REST API endpoints                       â”‚  â”‚  â”‚  â”‚   â”‚
â”‚   â”‚   â”‚   â”‚   â”‚  â€¢ Scheduler (APScheduler)                  â”‚  â”‚  â”‚  â”‚   â”‚
â”‚   â”‚   â”‚   â”‚   â”‚  â€¢ Cost Analyzer                            â”‚  â”‚  â”‚  â”‚   â”‚
â”‚   â”‚   â”‚   â”‚   â”‚  â€¢ AI Service (Gemini)                      â”‚  â”‚  â”‚  â”‚   â”‚
â”‚   â”‚   â”‚   â”‚   â”‚  â€¢ S3 Storage Service                       â”‚  â”‚  â”‚  â”‚   â”‚
â”‚   â”‚   â”‚   â”‚   â”‚  â€¢ Email Service (SMTP)                     â”‚  â”‚  â”‚  â”‚   â”‚
â”‚   â”‚   â”‚   â”‚   â”‚  â€¢ Datadog Service                          â”‚  â”‚  â”‚  â”‚   â”‚
â”‚   â”‚   â”‚   â”‚   â”‚                                              â”‚  â”‚  â”‚  â”‚   â”‚
â”‚   â”‚   â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                          FILES                                       â”‚   â”‚
â”‚   â”‚                                                                      â”‚   â”‚
â”‚   â”‚   /opt/aws-cost-agent/                                              â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ server.py              â† Main application                     â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ .env                   â† API keys (chmod 600)                 â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ venv/                  â† Python virtual environment           â”‚   â”‚
â”‚   â”‚   â””â”€â”€ data/                  â† Local fallback storage               â”‚   â”‚
â”‚   â”‚                                                                      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                           SECURITY GROUP                                     â”‚
â”‚                                                                              â”‚
â”‚   INBOUND:                          OUTBOUND:                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚   â”‚ SSH (22) â† Your IP only â”‚      â”‚ HTTPS (443) â†’ 0.0.0.0/0 â”‚             â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ SMTP (587)  â†’ 0.0.0.0/0 â”‚             â”‚
â”‚                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ Technology Stack

| Layer | Technology | Purpose |
|-------|------------|---------|
| **Runtime** | Python 3.11 | Core language |
| **Web Framework** | FastAPI | REST API |
| **Server** | Uvicorn | ASGI server |
| **Scheduler** | APScheduler | Weekly cron jobs |
| **AI** | Gemini 3 Flash | Cost analysis |
| **Storage** | AWS S3 (boto3) | Data persistence |
| **Email** | smtplib | SMTP client |
| **HTTP Client** | httpx | Datadog API calls |
| **Validation** | Pydantic | Data models |
| **Process Manager** | systemd | Service management |

---

## ğŸ” Security Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           SECURITY LAYERS                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LAYER 1: NETWORK SECURITY                                                    â”‚
â”‚                                                                              â”‚
â”‚   â€¢ EC2 Security Group restricts inbound traffic                            â”‚
â”‚   â€¢ SSH only from whitelisted IPs                                           â”‚
â”‚   â€¢ API port (8001) closed or restricted                                    â”‚
â”‚   â€¢ Outbound only to required services (443, 587)                           â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LAYER 2: CREDENTIAL SECURITY                                                 â”‚
â”‚                                                                              â”‚
â”‚   â€¢ All credentials in .env file                                            â”‚
â”‚   â€¢ .env has chmod 600 (owner read/write only)                              â”‚
â”‚   â€¢ No hardcoded secrets in code                                            â”‚
â”‚   â€¢ .gitignore prevents committing secrets                                  â”‚
â”‚   â€¢ Credentials loaded via os.environ.get()                                 â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LAYER 3: DATA SECURITY                                                       â”‚
â”‚                                                                              â”‚
â”‚   â€¢ S3 bucket access restricted to agent IAM user                           â”‚
â”‚   â€¢ Team data isolation (each team sees only their costs)                   â”‚
â”‚   â€¢ Admin-only access to consolidated reports                               â”‚
â”‚   â€¢ All API calls use HTTPS (TLS encryption)                                â”‚
â”‚   â€¢ SMTP uses TLS (port 587)                                                â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ Scalability Considerations

| Aspect | Current Design | Scale Option |
|--------|----------------|--------------|
| **Teams** | 84 accounts | Supports 500+ with pagination |
| **Storage** | S3 | Unlimited, auto-scales |
| **Compute** | Single EC2 | Can use Lambda for serverless |
| **AI Calls** | Sequential | Can parallelize with async |
| **Email** | Sequential | Can use SES for bulk |

---

**Architecture Version:** 3.0.0  
**Last Updated:** February 2026
